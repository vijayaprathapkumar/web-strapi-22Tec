"use strict";(self.webpackChunkmy_project=self.webpackChunkmy_project||[]).push([[3306],{3306:(j,c,t)=>{t.d(c,{ProtectedListView:()=>Et});var s=t(74081),E=t(27279),U=t(73354),B=t(27875),i=t(83),D=t(74758),o=t(15530),r=t(36938),a=t(29206),P=t(61020),e=t(51447),K=t(43639),f=t(49601),g=t(93118),W=t(45209),x=t(15816),$=t(97442),F=t(13576),Q=t(87830),V=t(47184),G=t(364),u=t(59461),J=t(71563),Y=t(49204),H=t(47853),z=t(74919),n=t(40464),d=t(98934),O=t(43433),T=t(75719),m=t(8175),M=t(6078),l=t(51943),C=t(55783),A=t(92249),y=t(41942),X=t(22919),w=t(53915),b=t(75041),q=t(30200),tt=t(91379),_=t(33299),st=t(33409),S=t(63645),Ot=t(7988),Tt=t(7055),mt=t(26757),At=t(58311),ct=t(24840),It=t(29510),Lt=t(16946),gt=t(10124),Ct=t(69530),vt=t(86961),ht=t(51527),Rt=t(19764),Ut=t(42982),Bt=t(26126);const ot=[{name:"name",key:"name",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],dt=()=>{(0,o.go)();const{formatMessage:I}=(0,P.Z)(),v=(0,o.lm)(),it=(0,K.j)(L=>L.admin_app.permissions.settings?.["api-tokens"]),{allowedActions:{canCreate:k,canDelete:rt,canUpdate:lt,canRead:h}}=(0,o.ss)(it),{push:at}=(0,e.k6)(),{trackUsage:p}=(0,o.rS)(),{startSection:et}=(0,o.c1)(),{_unstableFormatAPIError:Z}=(0,o.So)();E.useEffect(()=>{et("apiTokens")},[et]),E.useEffect(()=>{at({search:a.stringify({sort:"name:ASC"},{encode:!1})})},[at]);const Pt=ot.map(L=>({...L,metadatas:{...L.metadatas,label:I(L.metadatas.label)}}));(0,K.b)(()=>{p("willAccessTokenList",{tokenType:g.A})});const{data:R=[],isLoading:nt,error:N}=(0,f.u)(void 0,{skip:!h});E.useEffect(()=>{N&&v({type:"warning",message:Z(N)})},[N,Z,v]),E.useEffect(()=>{p("didAccessTokenList",{number:R.length,tokenType:g.A})},[R,p]);const[Mt]=(0,f.a)(),Dt=async L=>{try{const _t=await Mt(L);if("error"in _t){v({type:"warning",message:Z(_t.error)});return}p("didDeleteToken")}catch{v({type:"warning",message:{id:"notification.error",defaultMessage:"Something went wrong"}})}};return(0,s.jsxs)(U.o,{"aria-busy":nt,children:[(0,s.jsx)(o.SL,{name:"API Tokens"}),(0,s.jsx)(B.T,{title:I({id:"Settings.apiTokens.title",defaultMessage:"API Tokens"}),subtitle:I({id:"Settings.apiTokens.description",defaultMessage:"List of generated tokens to consume the API"}),primaryAction:k&&(0,s.jsx)(i.Q,{"data-testid":"create-api-token-button",startIcon:(0,s.jsx)(r.Z,{}),size:"S",onClick:()=>p("willAddTokenFromList",{tokenType:g.A}),to:"/settings/api-tokens/create",children:I({id:"Settings.apiTokens.create",defaultMessage:"Create new API Token"})})}),(0,s.jsxs)(D.D,{children:[!h&&(0,s.jsx)(o.ZF,{}),h&&R.length>0&&(0,s.jsx)(W.T,{permissions:{canRead:h,canDelete:rt,canUpdate:lt},headers:Pt,contentType:"api-tokens",isLoading:nt,onConfirmDelete:Dt,tokens:R,tokenType:g.A}),h&&k&&R.length===0&&(0,s.jsx)(o.dJ,{content:{id:"Settings.apiTokens.addFirstToken",defaultMessage:"Add your first API Token"},action:(0,s.jsx)(i.Q,{variant:"secondary",startIcon:(0,s.jsx)(r.Z,{}),to:"/settings/api-tokens/create",children:I({id:"Settings.apiTokens.addNewToken",defaultMessage:"Add new API Token"})})}),h&&!k&&R.length===0&&(0,s.jsx)(o.dJ,{content:{id:"Settings.apiTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})]})]})},Et=()=>{const I=(0,K.j)(v=>v.admin_app.permissions.settings?.["api-tokens"].main);return(0,s.jsx)(o.O4,{permissions:I,children:(0,s.jsx)(dt,{})})}},45209:(j,c,t)=>{t.d(c,{T:()=>Q});var s=t(74081),E=t(27279),U=t(86967),B=t(93153),i=t(50086),D=t(32370),o=t(10701),r=t(93415),a=t(4987),P=t(79213),e=t(15530),K=t(78665),f=t(98264),g=t(26784),W=t(61020),x=t(51447),$=t(47533),F=t(19003);const Q=({permissions:n,headers:d=[],contentType:O,isLoading:T=!1,tokens:m=[],onConfirmDelete:M,tokenType:l})=>{const{canDelete:C,canUpdate:A,canRead:y}=n;return(0,s.jsx)(e.tM,{headers:d,contentType:O,rows:m,withBulkActions:C||A||y,isLoading:T,onConfirmDelete:M,children:(0,s.jsx)(V,{tokenType:l,permissions:n,onConfirmDelete:M})})},V=({tokenType:n,permissions:d,rows:O=[],withBulkActions:T,onConfirmDelete:m})=>{const{canDelete:M,canUpdate:l,canRead:C}=d,[{query:A}]=(0,e.Kx)(),{formatMessage:y}=(0,W.Z)(),[,X]=A&&A.sort?A.sort.split(":"):[void 0,"ASC"],{push:w,location:{pathname:b}}=(0,x.k6)(),{trackUsage:q}=(0,e.rS)(),tt=[...O].sort((_,st)=>{const S=_.name.localeCompare(st.name);return X==="DESC"?-S:S});return(0,s.jsx)(U.p,{children:tt.map(_=>(0,s.jsxs)(B.Tr,{...(0,e.X7)({fn(){q("willEditTokenFromList",{tokenType:n}),w(`${b}/${_.id}`)},condition:l}),children:[(0,s.jsx)(i.Td,{maxWidth:(0,e.Q1)(250),children:(0,s.jsx)(D.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:_.name})}),(0,s.jsx)(i.Td,{maxWidth:(0,e.Q1)(250),children:(0,s.jsx)(D.Z,{textColor:"neutral800",ellipsis:!0,children:_.description})}),(0,s.jsx)(i.Td,{children:(0,s.jsx)(D.Z,{textColor:"neutral800",children:(0,s.jsx)(e.ij,{timestamp:new Date(_.createdAt)})})}),(0,s.jsx)(i.Td,{children:_.lastUsedAt&&(0,s.jsx)(D.Z,{textColor:"neutral800",children:(0,s.jsx)(e.ij,{timestamp:new Date(_.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:y({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]})})}),T&&(0,s.jsx)(i.Td,{children:(0,s.jsxs)(o.k,{justifyContent:"end",children:[l&&(0,s.jsx)(z,{tokenName:_.name,tokenId:_.id}),!l&&C&&(0,s.jsx)(H,{tokenName:_.name,tokenId:_.id}),M&&(0,s.jsx)(Y,{tokenName:_.name,onClickDelete:()=>m?.(_.id),tokenType:n})]})})]},_.id))})},G={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},u=({tokenName:n,tokenId:d,buttonType:O="edit",children:T})=>{const{formatMessage:m}=(0,W.Z)(),{location:{pathname:M}}=(0,x.k6)();return(0,s.jsx)(J,{forwardedAs:$.OL,to:`${M}/${d}`,title:m(G[O],{target:n}),children:T})},J=(0,F.ZP)(P.r)`
  svg {
    path {
      fill: ${({theme:n})=>n.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:n})=>n.colors.neutral800};
      }
    }
  }
`,Y=({tokenName:n,onClickDelete:d,tokenType:O})=>{const{formatMessage:T}=(0,W.Z)(),{trackUsage:m}=(0,e.rS)(),[M,l]=E.useState(!1),C=()=>{l(!1),m("willDeleteToken",{tokenType:O}),d()};return(0,s.jsxs)(r.x,{paddingLeft:1,onClick:A=>A.stopPropagation(),children:[(0,s.jsx)(a.h,{onClick:()=>{l(!0)},label:T({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${n}`}),name:"delete",borderWidth:0,icon:(0,s.jsx)(K.Z,{})}),(0,s.jsx)(e.QH,{onToggleDialog:()=>l(!1),onConfirm:C,isOpen:M})]})},H=({tokenName:n,tokenId:d})=>(0,s.jsx)(u,{tokenName:n,tokenId:d,buttonType:"read",children:(0,s.jsx)(f.Z,{})}),z=({tokenName:n,tokenId:d})=>(0,s.jsx)(u,{tokenName:n,tokenId:d,children:(0,s.jsx)(g.Z,{width:12})})},49601:(j,c,t)=>{t.d(c,{a:()=>D,b:()=>B,c:()=>i,d:()=>o,u:()=>U});var s=t(43639);const E=s.m.injectEndpoints({endpoints:r=>({getAPITokens:r.query({query:()=>"/admin/api-tokens",transformResponse:a=>a.data,providesTags:(a,P)=>[...a?.map(({id:e})=>({type:"ApiToken",id:e}))??[],{type:"ApiToken",id:"LIST"}]}),getAPIToken:r.query({query:a=>`/admin/api-tokens/${a}`,transformResponse:a=>a.data,providesTags:(a,P,e)=>[{type:"ApiToken",id:e}]}),createAPIToken:r.mutation({query:a=>({url:"/admin/api-tokens",method:"POST",data:a}),transformResponse:a=>a.data,invalidatesTags:[{type:"ApiToken",id:"LIST"}]}),deleteAPIToken:r.mutation({query:a=>({url:`/admin/api-tokens/${a}`,method:"DELETE"}),transformResponse:a=>a.data,invalidatesTags:(a,P,e)=>[{type:"ApiToken",id:e}]}),updateAPIToken:r.mutation({query:({id:a,...P})=>({url:`/admin/api-tokens/${a}`,method:"PUT",data:P}),transformResponse:a=>a.data,invalidatesTags:(a,P,{id:e})=>[{type:"ApiToken",id:e}]})}),overrideExisting:!1}),{useGetAPITokensQuery:U,useGetAPITokenQuery:B,useCreateAPITokenMutation:i,useDeleteAPITokenMutation:D,useUpdateAPITokenMutation:o}=E},93118:(j,c,t)=>{t.d(c,{A:()=>s,T:()=>E});const s="api-token",E="transfer-token"}}]);
