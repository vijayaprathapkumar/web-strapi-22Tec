"use strict";(self.webpackChunkmy_project=self.webpackChunkmy_project||[]).push([[5956],{75956:(z,c,s)=>{s.d(c,{ProtectedEditPage:()=>ss});var a=s(74081),e=s(27279),E=s(73354),M=s(27875),r=s(48102),m=s(74758),g=s(93415),h=s(10701),P=s(32370),A=s(23298),L=s(74577),I=s(79213),t=s(15530),U=s(59082),R=s(76827),K=s(71563),_=s(74919),i=s(47184),v=s(61020),O=s(51447),u=s(47533),C=s(47853),o=s(43639),p=s(13067),j=s(41195),N=s(91224),H=s(15816),d=s(97442),ds=s(13576),ls=s(87830),Es=s(364),Ms=s(59461),ms=s(49204),Ps=s(29206),Os=s(40464),Ds=s(98934),cs=s(43433),gs=s(75719),hs=s(8175),As=s(6078),Ls=s(51943),vs=s(55783),Cs=s(92249),fs=s(41942),Is=s(22919),Us=s(53915),us=s(75041),ps=s(30200),Ts=s(91379),Bs=s(33299),Rs=s(33409),Ks=s(63645),Ws=s(7988),xs=s(7055),js=s(26757),ys=s(58311),Ss=s(24840),Zs=s(29510),zs=s(16946),Ns=s(10124),Fs=s(69530),Vs=s(86961),Gs=s(51527),$s=s(19764),Ys=s(42982),Hs=s(26126),Js=s(64797),Xs=s(85811),Qs=s(51950);const w=C.Ry().shape({...N.C,isActive:C.Xg(),roles:C.IX().min(1,t.I0.required).required(t.I0.required)}),J=["email","firstname","lastname","username","isActive","roles"],k=()=>{const{formatMessage:n}=(0,v.Z)(),T=(0,O.$B)("/settings/users/:id")?.params?.id??"",{push:B}=(0,O.k6)(),l=(0,t.lm)(),{lockApp:V,unlockApp:G}=(0,t.o1)(),X=(0,o.p)(j.M,async()=>(await s.e(1674).then(s.bind(s,81674))).MagicLinkEE),{_unstableFormatAPIError:$,_unstableFormatValidationErrors:as}=(0,t.So)(),Q=(0,o.j)(p.s),{isLoading:ts,allowedActions:{canUpdate:Y}}=(0,t.ss)({read:Q.settings?.users.read??[],update:Q.settings?.users.update??[]}),[es]=(0,o.M)();(0,t.go)();const{data:os,error:y,isLoading:ns}=(0,o.k)({id:T},{refetchOnMountOrArgChange:!0}),[S]=os?.users??[];if(e.useEffect(()=>{y&&(y.name==="UnauthorizedError"?(l({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),B("/")):l({type:"warning",message:{id:"notification.error",defaultMessage:$(y)}}))},[y,$,B,l]),ns||!X||ts)return(0,a.jsxs)(E.o,{"aria-busy":"true",children:[(0,a.jsx)(t.SL,{name:"Users"}),(0,a.jsx)(M.T,{primaryAction:(0,a.jsx)(r.z,{disabled:!0,startIcon:(0,a.jsx)(U.Z,{}),type:"button",size:"L",children:n({id:"global.save",defaultMessage:"Save"})}),title:n({id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}),navigationAction:(0,a.jsx)(I.r,{as:u.OL,startIcon:(0,a.jsx)(R.Z,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:n({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsx)(m.D,{children:(0,a.jsx)(t.dO,{})})]});const Z={...i(S,J),roles:S.roles.map(({id:f})=>f),password:"",confirmPassword:""},is=async(f,W)=>{V?.();const D=await es({id:T,..._(f,"confirmPassword")});"error"in D&&(0,o.x)(D.error)?(D.error.name==="ValidationError"&&W.setErrors(as(D.error)),l({type:"warning",message:$(D.error)})):(l({type:"success",message:n({id:"notification.success.saved",defaultMessage:"Saved"})}),W.setValues({...i(f,J),password:"",confirmPassword:""})),G?.()};return(0,a.jsxs)(E.o,{children:[(0,a.jsx)(t.SL,{name:"Users"}),(0,a.jsx)(K.J9,{onSubmit:is,initialValues:Z,validateOnChange:!1,validationSchema:w,children:({errors:f,values:W,handleChange:D,isSubmitting:b,dirty:rs})=>(0,a.jsxs)(t.l0,{children:[(0,a.jsx)(M.T,{primaryAction:(0,a.jsx)(r.z,{disabled:b||!Y?!0:!rs,startIcon:(0,a.jsx)(U.Z,{}),loading:b,type:"submit",size:"L",children:n({id:"global.save",defaultMessage:"Save"})}),title:n({id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},{name:Z.username||(0,p.g)(Z?.firstname??"",Z.lastname)}),navigationAction:(0,a.jsx)(I.r,{as:u.OL,startIcon:(0,a.jsx)(R.Z,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:n({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsxs)(m.D,{children:[S?.registrationToken&&(0,a.jsx)(g.x,{paddingBottom:6,children:(0,a.jsx)(X,{registrationToken:S.registrationToken})}),(0,a.jsxs)(h.k,{direction:"column",alignItems:"stretch",gap:7,children:[(0,a.jsx)(g.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(h.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(P.Z,{variant:"delta",as:"h2",children:n({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})}),(0,a.jsx)(A.r,{gap:5,children:q.map(_s=>_s.map(x=>(0,a.jsx)(L.P,{...x.size,children:(0,a.jsx)(t.jm,{...x,disabled:!Y,error:f[x.name],onChange:D,value:W[x.name]})},x.name)))})]})}),(0,a.jsx)(g.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(h.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(P.Z,{variant:"delta",as:"h2",children:n({id:"global.roles",defaultMessage:"User's role"})}),(0,a.jsx)(A.r,{gap:5,children:(0,a.jsx)(L.P,{col:6,xs:12,children:(0,a.jsx)(j.S,{disabled:!Y,error:f.roles,onChange:D,value:W.roles})})})]})})]})]})]})})]})},q=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]],ss=()=>{const n=(0,t.lm)(),F=(0,o.j)(p.s),{isLoading:T,allowedActions:{canRead:B,canUpdate:l}}=(0,t.ss)({read:F.settings?.users.read??[],update:F.settings?.users.update??[]}),{state:V}=(0,O.TH)(),G=V?.from??"/";return e.useEffect(()=>{T||!B&&!l&&n({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[T,B,l,n]),T?(0,a.jsx)(t.dO,{}):!B&&!l?(0,a.jsx)(O.l_,{to:G}):(0,a.jsx)(k,{})}},41195:(z,c,s)=>{s.d(c,{M:()=>I,S:()=>t,a:()=>L});var a=s(74081),e=s(61020),E=s(43639),M=s(4987),r=s(97232),m=s(15530),g=s(78031),h=s(34547),P=s(19003),A=s(51950);const L=({children:_,target:i})=>{const v=(0,m.lm)(),{formatMessage:O}=(0,e.Z)(),{copy:u}=(0,m.VP)(),C=O({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),o=async()=>{await u(i)&&v({type:"info",message:{id:"notification.link-copied"}})};return(0,a.jsx)(m.Y_,{endAction:(0,a.jsx)(M.h,{label:C,noBorder:!0,icon:(0,a.jsx)(g.Z,{}),onClick:o}),title:i,titleEllipsis:!0,subtitle:_,icon:(0,a.jsx)("span",{style:{fontSize:32},children:"\u2709\uFE0F"}),iconBackground:"neutral100"})},I=({registrationToken:_})=>{const{formatMessage:i}=(0,e.Z)(),v=`${window.location.origin}${(0,E.K)()}/auth/register?registrationToken=${_}`;return(0,a.jsx)(L,{target:v,children:i({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})})},t=({disabled:_,error:i,onChange:v,value:O})=>{const{isLoading:u,roles:C}=(0,A.u)(),{formatMessage:o}=(0,e.Z)(),p=i?o({id:i,defaultMessage:i}):"",j=o({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),N=o({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),H=o({id:"app.components.Select.placeholder",defaultMessage:"Select"});return(0,a.jsx)(r.NU,{id:"roles",disabled:_,error:p,hint:N,label:j,name:"roles",onChange:d=>{v({target:{name:"roles",value:d}})},placeholder:H,startIcon:u?(0,a.jsx)(K,{}):void 0,value:O.map(d=>d.toString()),withTags:!0,required:!0,children:C.map(d=>(0,a.jsx)(r.ML,{value:d.id.toString(),children:o({id:`global.${d.code}`,defaultMessage:d.name})},d.id))})},U=(0,P.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,R=P.ZP.div`
  animation: ${U} 2s infinite linear;
`,K=()=>(0,a.jsx)(R,{children:(0,a.jsx)(h.Z,{})})},51950:(z,c,s)=>{s.d(c,{u:()=>r});var a=s(27279),e=s(15530),E=s(61020),M=s(43639);const r=(m={},g)=>{const{locale:h}=(0,E.Z)(),P=(0,e.Xe)(h,{sensitivity:"base"}),{data:A,error:L,isError:I,isLoading:t,refetch:U}=(0,M.z)(m,g);return{roles:a.useMemo(()=>[...A??[]].sort((K,_)=>P.compare(K.name,_.name)),[A,P]),error:L,isError:I,isLoading:t,refetch:U}}},91224:(z,c,s)=>{s.d(c,{C:()=>E});var a=s(15530),e=s(47853);const E={firstname:e.Z_().trim().required(a.I0.required),lastname:e.Z_(),email:e.Z_().email(a.I0.email).lowercase().required(a.I0.required),username:e.Z_().nullable(),password:e.Z_().min(8,a.I0.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Z_().min(8,a.I0.minLength).oneOf([e.iH("password"),null],"components.Input.error.password.noMatch").when("password",(M,r)=>M?r.required(a.I0.required):r)}}}]);
